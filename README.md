# シフト管理Webアプリ

宴会・婚礼スタッフのシフト管理を効率的に行うWebアプリケーションです。

## 🚀 セットアップ手順

### 1. 環境要件
- PHP 7.4以上
- MySQL 5.7以上
- Webサーバー（Apache/Nginx）

### 2. データベース設定
1. MySQLに接続し、以下のコマンドでデータベースを作成：
```sql
source database/schema.sql
```

2. `config/database.php`でデータベース接続情報を確認・修正

### 3. アプリケーション起動
1. Webサーバーを起動
2. ブラウザで `http://localhost/TSW/` にアクセス

## 📋 機能概要

### 1. スタッフ管理（`pages/users.php`）
- スタッフ情報の登録・編集・削除
- スキルレベルの管理（できる/まあまあできる/できない）
- ランク設定（ランナー/ランナー以外）

### 2. イベント管理（`pages/events.php`）
- イベント情報の登録・編集・削除
- 必要人数の設定（固定数または範囲指定）
- イベント種別の管理

### 3. 出勤時間入力（`pages/availability.php`）
- 管理者によるスタッフの出勤可能時間入力
- イベント別の出勤情報管理
- 一括設定機能

### 4. シフト自動作成（`pages/shift_assignment.php`）
- 条件に基づく自動シフト割当
- スキルレベル・ランク・出勤時間を考慮
- 統計情報の表示
- 印刷機能

## 🎯 自動割当アルゴリズム

### 割当条件（優先順）
1. **出勤可能時間がイベント時間と重複**
2. **スキルレベル**: できる > まあまあできる > できない
3. **ランク**: ランナー優先
4. **必要最小人数**を満たす最適配置

### 考慮要素
- 性別比率の表示
- 出勤回数上限の警告表示
- 未割当スタッフの管理

## 📁 ファイル構成

```
TSW/
├── index.php              # ダッシュボード
├── config/
│   └── database.php       # データベース設定
├── includes/
│   └── functions.php      # 共通関数
├── pages/
│   ├── users.php          # スタッフ管理
│   ├── events.php         # イベント管理
│   ├── availability.php   # 出勤時間入力
│   └── shift_assignment.php # シフト作成
├── api/
│   └── get_user_skills.php # スキル情報API
├── assets/css/
│   └── style.css          # スタイルシート
├── database/
│   └── schema.sql         # データベースダンプ
└── 要件定義書.md          # 要件定義書
```

## 🗄️ データベース構成

### テーブル一覧
- `users`: スタッフ情報
- `skills`: スキル情報
- `task_types`: タスク種別
- `events`: イベント情報
- `availability`: 出勤可能情報
- `assignments`: 割当結果（将来拡張用）

## 🔧 カスタマイズ

### 新しいタスク種別の追加
1. `task_types`テーブルにレコード追加
2. 各ページのフォームに選択肢を追加

### イベント種別の追加
`pages/events.php`の選択肢を編集

### スキルレベルの変更
`includes/functions.php`の`getSkillBadge()`関数を編集

## 📱 レスポンシブデザイン

- Bootstrap 5を使用
- モバイル・タブレット対応
- 印刷スタイル最適化

## 🎨 今後の拡張予定

- スタッフ個人による出勤登録
- 複数イベント同時シフト作成
- シフト履歴管理
- 通知機能
- API化

## 🔍 トラブルシューティング

### データベース接続エラー
1. `config/database.php`の設定を確認
2. MySQLサービスが起動していることを確認

### 表示が崩れる場合
1. ブラウザキャッシュをクリア
2. Bootstrap CDNの読み込み確認

### 文字化け
1. データベースの文字コードをUTF8に設定
2. PHPファイルの文字コードをUTF-8に統一
